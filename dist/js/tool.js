!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1),e.exports=n(6)},function(e,t,n){Nova.booting(function(e,t,o){e.component("mailer",n(2))})},function(e,t,n){var o=n(3)(n(4),n(5),!1,null,null,null);e.exports=o.exports},function(e,t){e.exports=function(e,t,n,o,a,s){var l,r=e=e||{},i=typeof e.default;"object"!==i&&"function"!==i||(l=e,r=e.default);var c,u="function"==typeof r?r.options:r;if(t&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0),n&&(u.functional=!0),a&&(u._scopeId=a),s?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=c):o&&(c=o),c){var d=u.functional,m=d?u.render:u.beforeCreate;d?(u._injectStyles=c,u.render=function(e,t){return c.call(t),m(e,t)}):u.beforeCreate=m?[].concat(m,c):[c]}return{esModule:l,exports:r,options:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["resourceId","panel"],data:function(){return{mailTemplates:[],selectedTemplate:"",body:"",to:"",subject:"",model:{}}},mounted:function(){this.getMailTemplates(),this.getMailable()},computed:{hasTemplates:function(){return Boolean(this.mailTemplates.length)},canSend:function(){return Boolean(""!==this.subject&&""!==this.body)}},methods:{getMailTemplates:function(){var e=this;Nova.request().get("/nova-mail/templates").then(function(t){var n=t.data;return e.mailTemplates=n.templates||[]})},getMailable:function(){var e=this;Nova.request().post("/nova-mail/mailable",{mailableClass:this.panel.fields[0].model,mailableId:this.resourceId}).then(function(t){var n=t.data;e.model=n.model,e.to=n.to})},handleTemplateSelection:function(){this.subject=this.selectedTemplate.subject,this.body=this.selectedTemplate.content},handleSendMail:function(){var e=this;Nova.request().post("/nova-mail/send/"+(this.selectedTemplate.id||""),{model:this.panel.fields[0].model,resourceId:this.resourceId,content:this.body,to:this.to,subject:this.subject}).then(function(t){t.data;e.$toasted.show("The mail has been sent.",{type:"success"}),e.resetForm()}).catch(function(t){return e.$toasted.show(t,{type:"error"})})},resetForm:function(){this.selectedTemplate="",this.subject="",this.body=""}}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),e._v(" "),n("div",{staticClass:"card mb-6 overflow-hidden"},[n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full pt-6 pb-2"},[n("h3",{staticClass:"text-90 font-bold text-lg mb-4"},[e._v("Send mail to "+e._s(e.to))]),e._v(" "),e.hasTemplates?n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedTemplate,expression:"selectedTemplate"}],staticClass:"form-control form-select mb-4",attrs:{name:"mail_template_select",id:"mail-template-select",dusk:"mail-template-select"},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedTemplate=t.target.multiple?n:n[0]},e.handleTemplateSelection]}},[n("option",{attrs:{value:"",disabled:"disabled"}},[e._v("Select Mail Templateâ€¦")]),e._v(" "),e._l(e.mailTemplates,function(t,o){return n("option",{key:o,domProps:{value:t,textContent:e._s(t.name)}})})],2):e._e(),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.subject,expression:"subject"}],staticClass:"w-full form-control form-input form-input-bordered",attrs:{name:"subject",id:"subject",dusk:"subject",type:"text",placeholder:"Subject"},domProps:{value:e.subject},on:{input:function(t){t.target.composing||(e.subject=t.target.value)}}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.body,expression:"body"}],staticClass:"w-full form-control form-input form-input-bordered py-3 h-auto mt-4",attrs:{name:"template_override",id:"template-override",dusk:"template-override",rows:"10",placeholder:"Body"},domProps:{value:e.body},on:{input:function(t){t.target.composing||(e.body=t.target.value)}}})])]),e._v(" "),n("div",{staticClass:"flex justify-between px-8 pb-6"},[n("div",{staticClass:"help-text"},[e._v("Adjust the mail template or craft an email from scratch above! You can use normal blade syntax and include attributes from this resources model...")]),e._v(" "),n("button",{staticClass:"btn btn-default btn-primary inline-flex items-center relative mt-4",attrs:{type:"submit",disabled:!e.canSend},on:{click:e.handleSendMail}},[e._v("Send Mail")])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"flex items-center mb-3"},[t("h4",{staticClass:"text-90 font-normal text-2xl flex-no-shrink"},[this._v("Mail")])])}]}},function(e,t){}]);